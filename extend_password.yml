---
- hosts: all
  become: true
  remote_user: ncloud
  become_user: root 
  become_method: su
  gather_facts: no
  tasks:
    - name: 만료기간 연장
      user:
       date: "{{ current_date }}"
      ansible.builtin.command:
        cmd: chage -d {{ current_date }} ncloud
      register: result
      changed_when: result.rc == 0
      failed_when: result.rc != 0
      when: use_current_date | bool
